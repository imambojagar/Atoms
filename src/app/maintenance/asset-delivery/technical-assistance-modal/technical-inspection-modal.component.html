<div class="modal-header">
    <div class="modal-title text-primary font-weight-bolder" id="example-modal-sizes-title-lg">
        <h4 class="d-flex align-items-center text-primary">Technical Inspection for Item {{ItemNum}}</h4>
    </div>
</div>

<div class="modal-body">
    <form action="#" [formGroup]="technicalInspectionForm">
        <div class="row py-3">
            <div class="col-md-3 col-xl-3 col-xxl-3">
                <label class="fs-6 fw-bold form-label">Asset Name</label>
                <input type="text" class="form-control form-control-lg form-control-solid" readonly formControlName="assetName" pInputText />
                <button type="button" (click)="openDialog()" pButton
                class="p-button-info col-lg-2 asset-lookup mt-2" icon="pi pi-external-link"
                label="Select Model"></button>
              </div>


              <div class="col-md-3 col-xl-3 col-xxl-3">
                <label class="fs-6 fw-bold form-label">Model</label>
                <input type="text" class="form-control form-control-lg form-control-solid" readonly formControlName="Model" pInputText />
              </div>

              <div class="col-md-3 col-xl-3 col-xxl-3">
              <label class="fs-6 fw-bold form-label">Manufacturer</label>
              <input type="text" class="form-control form-control-lg form-control-solid" readonly formControlName="Manufacturer" pInputText />
              </div>

            <div class="col-md-3 col-lg-3 col-xl-3 col-xxl-3">
                <label class="fs-6 fw-bold form-label">Power Supply Type</label>
                <p-dropdown [options]="powerSupplyTypelist" placeholder="Please select" formControlName="powerSupplyTypeId"
                (onChange)="changePowerSupplyType($event)" optionLabel="name" optionValue="id" [style]="{'width':'100%'}" [filter]="true" filterBy="name" [showClear]="true">
              </p-dropdown>
              <div *ngIf=" technicalInspectionForm.get('powerSupplyTypeId')?.hasError('required') && technicalInspectionForm.get('powerSupplyTypeId')?.touched " class="fv-plugins-message-container invalid-feedback"> Filed is required </div>
            </div>

            <div class="col-md-3 col-lg-3 col-xl-3 col-xxl-3">
                <label class="fs-6 fw-bold form-label">Power Reading</label>
                <input type="text" formControlName="powerReading" name="powerReading" class="form-control form-control-sm form-control-solid" placeholder="Enter ..." />
                <div *ngIf=" technicalInspectionForm.get('powerReading')?.hasError('required') && technicalInspectionForm.get('powerReading')?.touched " class="fv-plugins-message-container invalid-feedback"> Filed is required </div>
            </div>
        </div>
        <div class="row py-3">
            <div class="col-md-2 col-lg-2 col-xl-2 col-xxl-2">
                <label class="fs-6 fw-bold form-label">Max Current</label>
                <input type="text" formControlName="maxCurrent" name="maxCurrent" class="form-control form-control-sm form-control-solid" placeholder="Enter ..." />
                <div *ngIf=" technicalInspectionForm.get('maxCurrent')?.hasError('required') && technicalInspectionForm.get('maxCurrent')?.touched " class="fv-plugins-message-container invalid-feedback"> Filed is required </div>
            </div>
            <div class="col-md-2 col-lg-2 col-xl-2 col-xxl-2">
                <label class="fs-6 fw-bold form-label">Voltage</label>
                <p-dropdown [options]="voltagelist" placeholder="Please select" formControlName="voltageId" (onChange)="changeVoltage($event)"
                 optionLabel="name" optionValue="id" [style]="{'width':'100%'}" [filter]="true" filterBy="name" [showClear]="true">
              </p-dropdown>
              <div *ngIf=" technicalInspectionForm.get('voltageId')?.hasError('required') && technicalInspectionForm.get('voltageId')?.touched " class="fv-plugins-message-container invalid-feedback"> Filed is required </div>
            </div>
            <div class="col-md-2 col-lg-2 col-xl-2 col-xxl-2">
                <label class="fs-6 fw-bold form-label">Frequency</label>
                <p-dropdown [options]="frequencylist" placeholder="Please select" formControlName="frequencyId" (onChange)="changeFrequency($event)"
                 optionLabel="name" optionValue="id" [style]="{'width':'100%'}" [filter]="true" filterBy="name" [showClear]="true">
              </p-dropdown>
              <div *ngIf=" technicalInspectionForm.get('frequencyId')?.hasError('required') && technicalInspectionForm.get('frequencyId')?.touched " class="fv-plugins-message-container invalid-feedback"> Filed is required </div>
            </div>
            <div class="col-md-3 col-lg-3 col-xl-3 col-xxl-3">
                <label class="fs-6 fw-bold form-label">Cost Center</label>
                <p-dropdown [options]="costCenterList" placeholder="Please select"
                formControlName="costCenter" (onChange)="changeCostCenter($event)" optionLabel="costCenter" optionValue="costCenter" [style]="{'width':'100%'}" [filter]="true" filterBy="name" [showClear]="true"> </p-dropdown>
               <div *ngIf=" technicalInspectionForm.get('costCenter')?.hasError('required') && technicalInspectionForm.get('costCenter')?.touched " class="fv-plugins-message-container invalid-feedback"> Filed is required </div>
            </div>
            <div class="col-md-3 col-lg-3 col-xl-3 col-xxl-3">
                <label class="fs-6 fw-bold form-label">Quantity Received</label>
                <input type="number" formControlName="quantity" name="quantity" readonly class="form-control form-control-sm form-control-solid" placeholder="Enter ..." />
                <div *ngIf=" technicalInspectionForm.get('quantity')?.hasError('required') && technicalInspectionForm.get('quantity')?.touched " class="fv-plugins-message-container invalid-feedback"> Filed is required </div>
            </div>
        </div>
        <div *ngIf="getControls('technicalInspectionItems').length >0 ">
        <h3 class="d-flex align-items-center text-primary mt-8">Inspection Items</h3>
        <hr class="my-2 align-items-center text-primary">
         </div>
        <div formArrayName="technicalInspectionItems">
            <div *ngFor="let info of getControls('technicalInspectionItems'); let i=index"
                class="formline add-more-value-border add-more-values margin-bottom-add-more">
                <div [formGroupName]="i" class="d-flex">
                    <fieldset class="formline">
                        <div class="row py-3">
                            <div class="col-md-4 col-lg-4 col-xl-4 col-xxl-4">
                                <label class="fs-6 fw-bold form-label">Asset Number</label>
                                <p-autoComplete [delay]="1000"  placeholder="Please enter . . . " [style]="{'width':'100%'}" [inputStyle]="{'width':'100%'}"
                                formControlName="assetNumber" [suggestions]="assetsData" dataKey="id"  field="assetNumber" (completeMethod)="getAssetNumbers($event.query,i)"
                               (onSelect)="selectAsset($event,i)">
                               </p-autoComplete>
                                <!-- <input type="text" formControlName="serialNumber" name="serialNumber" class="form-control form-control-sm form-control-solid" placeholder="Enter ..." /> -->
                            </div>
                            <div class="col-md-4 col-lg-4 col-xl-4 col-xxl-4">
                                <label class="fs-6 fw-bold form-label">Serial No</label>
                                <input type="text" formControlName="serialNumber" name="serialNumber" readonly
                                    class="form-control form-control-sm form-control-solid" placeholder="Enter ..." />
                            </div>
                            <div class="col-md-4 col-lg-4 col-xl-4 col-xxl-4">
                                <label class="fs-6 fw-bold form-label">Building</label>
                                <input type="text" formControlName="location" name="location"
                                    class="form-control form-control-sm form-control-solid" readonly placeholder="Enter ..." />
                            </div>
                            <div class="col-md-4 col-lg-4 col-xl-4 col-xxl-4">
                                <label class="fs-6 fw-bold form-label">Floor</label>
                                <input type="text" formControlName="floor" name="floor" readonly class="form-control form-control-sm form-control-solid" />
                            </div>
                        </div>
                        <div class="row py-3">
                            <div class="col-md-4 col-lg-4 col-xl-4 col-xxl-4">
                                <label class="fs-6 fw-bold form-label">Date</label>
                                <p-calendar [showOnFocus]="false" placeholder="Please select date" [showIcon]="true" [showButtonBar]="true"
                                    [style]="{'width':'100%'}" [inputStyle]="{'width':'100%'}"
                                    formControlName="inspectionDate" dateFormat="yy-mm-dd" dataType="string">
                                </p-calendar>
                            </div>
                            <div class="col-md-4 col-lg-4 col-xl-4 col-xxl-4">
                                <label class="fs-6 fw-bold form-label"> </label>
                                <label class="form-check form-switch form-check-custom form-check-solid mt-7">
                                    <input formControlName="status" name="status" (click)="onNoClick($event)" class="form-check-input" type="checkbox" value="1" />
                                        <span class="form-check-label fw-bold text-gray-400">Status</span></label>
                            </div>
                        </div>
                        <div class="row py-3">
                            <p-accordion class="w-full">
                                <p-accordionTab>
                                    <ng-template pTemplate="header">
                                        <div class="flex align-items-center"> <span class="vertical-align-middle">Inspection Operations</span> </div>
                                    </ng-template>
                                    <ng-template pTemplate="content">
                                        <h5 class="d-flex align-items-center text-primary mt-2">Tests</h5>
                                        <div class="row py-3">
                                            <div class="col-md-12 col-lg-12 col-xl-12 col-xxl-12">
                                                <label class="form-check form-switch form-check-custom form-check-solid mt-1">
                                                    <input formControlName="flagphysicalInspection" name="flagphysicalInspection" (change)="CheckTestAlert(i)" class="form-check-input" type="checkbox" value="1" />
                                                        <span class="form-check-label fw-bold text-gray-400">Physical Inspection As Per Manufacturer Instructions</span></label>
                                            </div>
                                            <div class="col-md-12 col-lg-12 col-xl-12 col-xxl-12">
                                                <label class="form-check form-switch form-check-custom form-check-solid mt-2">
                                                    <input formControlName="flagFunctionPerformance" name="flagFunctionPerformance" (change)="CheckTestAlert(i)" class="form-check-input" type="checkbox" value="1" />
                                                    <span class="form-check-label fw-bold text-gray-400">Functional Performance As Per Results Of Manufacturer Recommended Check List</span></label>
                                            </div>
                                            <div class="col-md-12 col-lg-12 col-xl-12 col-xxl-12">
                                                <label class="form-check form-switch form-check-custom form-check-solid mt-2">
                                                    <input formControlName="flagGroundingResistance" name="flagGroundingResistance" (change)="CheckTestAlert(i)" class="form-check-input" type="checkbox" value="1" />
                                                    <span class="form-check-label fw-bold text-gray-400">Grounding Resistance:Ω </span></label>
                                            </div>
                                            <div class="col-md-12 col-lg-12 col-xl-12 col-xxl-12">
                                                <label class="form-check form-switch form-check-custom form-check-solid mt-2">
                                                    <input formControlName="flagChassiss" name="flagChassiss" class="form-check-input" (change)="CheckTestAlert(i)" type="checkbox" value="1" />
                                                    <span class="form-check-label fw-bold text-gray-400">Chassis Leakage Current:µA</span>
                                                </label>
                                            </div>
                                            <div class="col-md-12 col-lg-12 col-xl-12 col-xxl-12">
                                                <label class="form-check form-switch form-check-custom form-check-solid mt-2">
                                                    <input formControlName="flagLeadsLeakage" name="flagLeadsLeakage" class="form-check-input" (change)="CheckTestAlert(i)" type="checkbox" value="1" />
                                                        <span class="form-check-label fw-bold text-gray-400">Leads Leakage Current:µA</span>
                                                </label>
                                            </div>
                                            <h5 class="d-flex align-items-center text-primary mt-1">Aletrs</h5>
                                            <div class="col-md-12 col-lg-12 col-xl-12 col-xxl-12">
                                                <label class="form-check form-switch form-check-custom form-check-solid mt-2">
                                                    <input formControlName="flagAlert" name="flagAlert" class="form-check-input" (change)="CheckTestAlert(i)" type="checkbox" value="1" />
                                                    <span class="form-check-label fw-bold text-gray-400">This Device Is Not Subject To Any Alert Or Recall Until The Date Of Preparation Of This Inspection Form.</span></label>
                                            </div>
                                        </div>
                                    </ng-template>
                                </p-accordionTab>
                            </p-accordion>
                        </div>
                    </fieldset>
                </div>
            </div>
        </div>
    </form>
</div>
<div class="modal-footer">
    <button type="button" class="btn btn-light btn-active-light-primary me-2" (click)="modal.dismiss()">Cancel </button>
    <button type="submit" class="btn btn-primary me-2" (click)="save()" *ngIf="hideContinue==true">Save </button>
</div>

<!-- <p-dialog header="lookup search" [(visible)]="showDialog" [modal]="true"
    [style]="{width :'60vw',height:'60hw'}" [maximizable]="true" [draggable]="false" [resizable]="false">
     -->
<div #drawerFilter
[ngClass]=" showmodals ? 'show' : ''"
class="offcanvas offcanvas-end offcanvas-container w-50 ps-md-4 ngprime-custom" id="r-step-1" aria-modal="true" role="dialog">
  <div class="offcanvas-header">
    <h1 class="offcanvas-title offcanvas-heading">Search Asset</h1>
    <button type="button" class="btn-close" (click)="close_modal()"></button>
  </div>
  <div class="p-3">
    <div class="row">
      <div>
          <!-- <app-search-component (OnSearch)="searchModelDefinition()" (OnReset)="Reset()"> -->


              <form [formGroup]="searchForm">
                  <div class="row py-3">
                  <div class="col-md-6 col-xl-3 col-xxl-3 mb-5">
                      <label class="form-label ">Asset Name</label>
                      <p-autoComplete [delay]="1000" [suggestions]="assetNames" field="assetname" formControlName="assetNDId"
                          (completeMethod)="selectAssetName($event)" (onSelect)="bindAssetName($event)"
                          (onClear)="clearAssetName()"></p-autoComplete>
                  </div>
                  <div class="col-md-6 col-xl-3 col-xxl-3 mb-5">
                    <label class="form-label ">Model</label>
                    <p-autoComplete [delay]="1000" [suggestions]="models" field="name" formControlName="modelId"
                        (completeMethod)="selectModel($event)" (onSelect)="bindModel($event)"
                        (onClear)="clearModel()"></p-autoComplete>
                  </div>
                  <div class="col-md-6 col-xl-3 col-xxl-3 mb-5">
                          <label class="form-label ">Manufacturer</label>
                          <p-autoComplete [delay]="1000" formControlName="manufacturerId" [suggestions]="manufacturers"
                              field="name" (completeMethod)="selectManufacturer($event)"
                              (onSelect)="bindManufacturer($event)" (onClear)="clearManufacturer()"></p-autoComplete>
                  </div>


                  </div>
              </form>


          <!-- </app-search-component> -->
      </div>
      <div>
        <p-table #dt [value]="modelDefinitions"
            [lazy]="true" styleClass="p-datatable-striped p-datatable-gridlines" [rows]="pageSize"
            [tableStyle]="{width :'60vw'}" [lazy]="true" [totalRecords]="totalRows"
            [rowHover]="true" dataKey="id">
            <ng-template pTemplate="caption">
                <div>
                    Models Definition Table <br>
                    <span class="total_rows_data"> Total: {{ totalRows }} </span>
                </div>
            </ng-template>
            <ng-template pTemplate="header">
                <tr>
                    <th>Model Definition Code</th>
                    <th>Asset Name</th>
                    <th>Model</th>
                    <th>Manufacturer</th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-modelDefinition>

                <tr (click)="selectRow(modelDefinition.id)">
                    <td>{{modelDefinition.modelDefCode}}</td>
                    <td>{{modelDefinition.assetNDAssetName}}</td>
                    <td>{{modelDefinition.modelTaxonomyName}}</td>
                    <td>{{modelDefinition.modelParentTaxonomyName}}</td>
                </tr>
            </ng-template>

        </p-table>
        <p-paginator [rows]="pageSize" [totalRecords]="totalRows" (onPageChange)="paginate($event)"
              [showCurrentPageReport]="true"
              currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"></p-paginator>
      </div>

      <ng-template pTemplate="footer">
          <p-button icon="pi pi-times" (click)="showDialog=false" label="Cancel" styleClass="p-button-text"></p-button>
      </ng-template>
    </div>
  </div>
</div>
<!-- </p-dialog> -->

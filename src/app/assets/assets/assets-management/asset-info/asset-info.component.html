<form [formGroup]="assetFormService.assetInfoForm">

  <h3>Model Info</h3>
  <hr>
  <div class="row py-3">

    <div class="col-xxl-6 col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
      <div class="row">
        <div class="col-lg-12 col-md-12">
          <div class="form-floating mb-2">
            <input type="text" class="form-control header-search-background" id="assetName" formControlName="assetName"
              pInputText placeholder="Asset Name" />
            <label for="assetName">Asset Name</label>
          </div>
        </div>

        <div class="col-lg-3 col-md-3">
          <button type="button" (click)="openDialog()" pButton class="btn btn-light" icon="pi pi-external-link"
            label="Select Model" *ngIf="assetFormService.isAddMode"></button>
        </div>
      </div>
    </div>


    <div class="col-xxl-6 col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
      <div class="form-floating mb-2">
        <input type="text" class="form-control header-search-background" id="Model" formControlName="Model" pInputText
          placeholder="Model" />
        <label for="Model" class="">Model</label>
      </div>
    </div>

    <div class="col-xxl-6 col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
      <div class="form-floating mb-2">
        <input type="text" class="form-control header-search-background" id="Manufacturer"
          formControlName="Manufacturer" pInputText placeholder="Manufacturer" />
        <label for="Manufacturer" class="">Manufacturer</label>
      </div>
    </div>

    <div class="col-xxl-6 col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
      <div class="form-floating mb-2">

        <p-dropdown [options]="assetFormService.suppliers" optionLabel="suppliername" formControlName="supplier"
          placeholder="Please select . . ."></p-dropdown> <label class="">Supplier</label>
      </div>
    </div>

    <div class="col-xxl-6 col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12" *ngIf="false">
      <div class="form-floating mb-2">

        <p-autoComplete [delay]="1000" placeholder="Please enter model definition" formControlName="modelDefinition"
          (onSelect)="assetFormService.onSelectName($event)" [suggestions]="assetFormService.ModelDefinitions"
          (completeMethod)="assetFormService.searchonmodels($event)" field="modelDefCode" dataKey="id"></p-autoComplete>
        <label class="form-label required" for="modelDefinition">Model Definition</label>
      </div>
    </div>

  </div>

  <h3>Asset Info</h3>
  <hr>
  <div class="row py-3">


    <div class="col-xxl-6 col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
      <div class="form-floating mb-2">
        <label for="assetReplace" class="">Replacement</label>
        <p-dropdown [options]="assetFormService.Asset_Replaces" optionLabel="name" formControlName="assetReplace"
          id="assetReplace" placeholder="Please select . . ." (onChange)="clearOldAsset()"></p-dropdown>
      </div>
    </div>
    <div class="col-xxl-6 col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12"
      *ngIf="assetFormService.assetInfoForm.get('assetReplace')?.value?.value==1">

      <!--  <p-autoComplete [delay]="1000"
          formControlName="oldAsset"

          [suggestions]="assetFormService.oldAssetNums"
          field="assetNumber" placeholder="Please enter . . . ."
          (completeMethod)="assetFormService.getAssetNumbers($event.query)"
          (onSelect)="assetFormService.getAssetNumbers($event.query)"></p-autoComplete> -->

      <div class="row">
        <div class="col-lg-10 col-md-10">
          <div class="form-floating mb-2">
            <label for="aa" class="">Old Asset Num</label>
            <input id="aa" type="text" class="form-control header-search-background"
              value="{{assetFormService.oldassetnumber}}" pInputText readonly />
          </div>
        </div>
        <div class="col-lg-2 col-md-2">
          <p-button type="button" (click)="openDialogasset('oldasset')" class="btn btn-light"
            icon="pi pi-external-link"></p-button>
        </div>
      </div>
    </div>
    <div class="col-xxl-6 col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12">
      <div class="form-floating mb-2">
        <label class="">Parent - Child</label>
        <p-dropdown [options]="assetFormService.Parent_Childs" optionLabel="name" formControlName="isParent"
          placeholder="Please select . . . " (onChange)="clearParentAsset()"></p-dropdown>
      </div>
    </div>
    <div class="col-xxl-6 col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12"
      *ngIf="assetFormService.assetInfoForm.get('isParent')?.value?.value==1">
      <div class="form-floating mb-2">
        <label class="">Parent Asset Number</label>
        <!--<p-autoComplete [delay]="1000"
        formControlName="parentAsset"
          [suggestions]="assetFormService.Asset_SNs"
          field="assetNumber"
          (completeMethod)="assetFormService.getAssetNumbers($event.query)"
          (onSelect)="assetFormService.getAssetNumbers($event.query)"></p-autoComplete>-->
        <div class="d-flex">
          <div class="col-lg-10">
            <input id="mm" type="text" value="{{assetFormService.parentassetnumber}}" pInputText readonly />

          </div>
          <button type="button" (click)="openDialogasset('parentassetnumber')" pButton class="p-button-info col-lg-2 "
            icon="pi pi-external-link"></button>
        </div>
      </div>
    </div>
    <div class="col-xxl-6 col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12 ">
      <div class="form-floating mb-2">
        <p-dropdown [options]="assetFormService.isEnabled" optionLabel="name" formControlName="isEnabled"
          placeholder="Plaese select . . ."></p-dropdown>
        <label class="">Enabled</label>
      </div>
    </div>
    <div class="col-xxl-6 col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12 mb-3">
      <div class="form-floating mb-2">
        <input id="tagCode" formControlName="tagCode" type="text" class="form-control header-search-background"
          pInputText placeholder="Tag Code" />
        <label for="tagCode" class="form-label">Tag Code</label>
      </div>
    </div>
    <div class="col-xxl-6 col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12 mb-3">
      <div class="form-floating mb-2">
        <input id="missionCritical" formControlName="missionCritical" class="form-control header-search-background"
          type="text" pInputText readonly placeholder="Mission Critical" />
        <label for="missionCritical" class="form-label">Mission Critical</label>
      </div>
    </div>
    <div class="col-xxl-6 col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12 mb-3">
      <div class="form-floating mb-2">
        <input id="essentialEquipement" formControlName="essentialEquipement"
          class="form-control header-search-background" type="text" pInputText readonly
          placeholder="Essential Equipement" />
        <label for="essentialEquipement" class="form-label">Essential Equipement</label>
      </div>
    </div>

    <div class="col-xxl-6 col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12 ">
      <div class="form-floating mb-2">
        <input type="text" id="ipAddress" class="form-control header-search-background"
          placeholder="Please Enter IP Address" formControlName="ipAddress" pInputText />
        <label for="ipAddress" class=""><span></span>IP Address</label>
      </div>
    </div>
    <div class="col-xxl-6 col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12 ">
      <div class="form-floating mb-2">
        <input type="text" id="macAddress" class="form-control header-search-background"
          placeholder="Please Enter Mac Address" formControlName="macAddress" inputId="macAddress" pInputText>
        <label for="macAddress" class="">Mac Address</label>
      </div>
    </div>
    <div class="col-xxl-6 col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12 ">
      <div class="form-floating mb-2">
        <input type="text" class="form-control header-search-background" placeholder="Please Enter Port Number"
          id="portNumber" formControlName="portNumber" pInputText />
        <label for="portNumber" class="">Port Number</label>
      </div>
    </div>
    <div class="col-xxl-6 col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12 ">
      <div class="form-floating mb-2">
        <input id="retirementType" formControlName="retirementTypeName" class="form-control header-search-background"
          type="text" pInputText readonly placeholder="Retirement Type" />
        <label for="retirementType" class="">Retirement Type</label>
      </div>
    </div>

    <div class="col-xxl-6 col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12 ">
      <div class="form-floating mb-2">
        <input id="retirementStatus" formControlName="retirementStatusName"
          class="form-control header-search-background" type="text" pInputText readonly
          placeholder="Retirement Status" />
        <label for="retirementStatus" class="">Retirement Status</label>
      </div>
    </div>
    <div class="col-xxl-6 col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12 ">
      <div class="form-floating mb-2">

        <p-calendar [showIcon]="true" [showOnFocus]="false" formControlName="retirementDate" dateFormat="dd-mm-yy"
          placeholder="Please select date" id="retirementDate"></p-calendar> <label for="retirementDate" class="">
          Retirement Date</label>
      </div>
    </div>
    <div class="col-xxl-6 col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12 ">
      <img [src]="assetFormService.imageSource ? assetFormService.imageSource : 'assets/img/imageplaceholder.png'"
        style="width: 120px; height: 90px;">
      <div class="form-floating mb-2">
        <input type="file" #fileInput style="display:none;" (change)="assetFormService.uploadFile($event)">
        <p-button (click)="fileInput.click()" label="" icon="pi pi-upload" class="btn btn-light"></p-button>
        <p-button label="" class="btn btn-light" icon="pi pi-trash" (click)="assetFormService.removeImage()"></p-button>
      </div>
    </div>

  </div>
</form>

<!-- <p-dialog header="lookup search" [(visible)]="showDialog" [modal]="true"
    [style]="{width :'60vw',height:'60hw'}" [maximizable]="true" [draggable]="false" [resizable]="false"> -->
<div #drawerFilter [ngClass]=" showDialog ? 'show' : ''"
  class="offcanvas offcanvas-end offcanvas-container w-50 ps-md-4 ngprime-custom" id="r-step-1" aria-modal="true"
  role="dialog">
  <div class="offcanvas-header">
    <h1 class="offcanvas-title offcanvas-heading">Select Asset</h1>
    <button type="button" class="btn-close" (click)="close_dialog()"></button>
  </div>
  <div>
    <!--  <app-search-component (OnSearch)="searchModelDefinition()" (OnReset)="Reset()">
              <form [formGroup]="searchForm">
                  <div class="row py-3">
                  <div class="col-xxl-6 col-xl-6 col-lg-6 col-md-6 col-sm-12 col-12 ">
                      <label class="form-label ">Asset Name</label>
                      <p-autoComplete [delay]="1000" [suggestions]="assetNames" field="assetname" formControlName="assetNDId"
                          (completeMethod)="selectAssetName($event)" (onSelect)="bindAssetName($event)"
                          (onClear)="clearAssetName()"></p-autoComplete>
                  </div>
                  <div class="col-md-6 col-xl-3 col-xxl-3 ">
                    <label class="form-label ">Model</label>
                    <p-autoComplete [delay]="1000" [suggestions]="models" field="name" formControlName="modelId"
                        (completeMethod)="selectModel($event)" (onSelect)="bindModel($event)"
                        (onClear)="clearModel()"></p-autoComplete>
                  </div>
                  <div class="col-md-6 col-xl-3 col-xxl-3 ">
                          <label class="form-label ">Manufacturer</label>
                          <p-autoComplete [delay]="1000" formControlName="manufacturerId" [suggestions]="manufacturers"
                              field="name" (completeMethod)="selectManufacturer($event)"
                              (onSelect)="bindManufacturer($event)" (onClear)="clearManufacturer()"></p-autoComplete>
                  </div>


                  </div>
              </form>
          </app-search-component> -->
  </div>
  <div>
    <p-table #dt [value]="modelDefinitions" [loading]="loading" [lazy]="true"
      styleClass="p-datatable-striped p-datatable-gridlines" [rows]="pageSize" [tableStyle]="{width :'60vw'}"
      [lazy]="true" [totalRecords]="totalRows" [rowHover]="true" dataKey="id">
      <ng-template pTemplate="caption">
        <div>
          Models Definition Table <br>
          <span class="total_rows_data"> Total: {{ totalRows }} </span>
        </div>
      </ng-template>
      <ng-template pTemplate="header">
        <tr>
          <th>Model Definition Code</th>
          <th>Asset Name</th>
          <th>Model</th>
          <th>Manufacturer</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-modelDefinition>

        <tr (click)="selectRow(modelDefinition.id)">
          <td>{{modelDefinition.modelDefCode}}</td>
          <td>{{modelDefinition.assetNDAssetName}}</td>
          <td>{{modelDefinition.modelTaxonomyName}}</td>
          <td>{{modelDefinition.modelParentTaxonomyName}}</td>
        </tr>
      </ng-template>

    </p-table>
    <p-paginator [rows]="pageSize" [totalRecords]="totalRows" (onPageChange)="paginate($event)"
      [showCurrentPageReport]="true"
      currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"></p-paginator>

  </div>

  <ng-template pTemplate="footer">
    <p-button icon="pi pi-times" (click)="showDialog=false" label="Cancel" styleClass="p-button-text"></p-button>
  </ng-template>
</div>

<div *ngIf="showDialog" class="offcanvas-backdrop fade show" (click)="close_dialog()"></div>
<!-- </p-dialog> -->

<!--from here deema -->
<!-- <p-dialog header="lookup search" [(visible)]="showDialogasset" [modal]="true"
    [style]="{width :'60vw',height:'60hw'}
    " [maximizable]="true" [draggable]="false" [resizable]="false"> -->

<div *ngIf="showDialogasset" class="offcanvas-backdrop fade show" (click)="close_dialogassets()"></div>
<div #drawerFilter [ngClass]=" showDialogasset ? 'show' : ''"
  class="offcanvas offcanvas-end offcanvas-container w-50 ps-md-4 ngprime-custom" id="r-step-1" aria-modal="true"
  role="dialog">
  <div class="offcanvas-header">
    <h1 class="offcanvas-title offcanvas-heading">Select Asset</h1>
    <button type="button" class="btn-close" (click)="close_dialogassets()"></button>
  </div>
  <div>
    <!--  <app-search-component (OnSearch)="search()" (OnReset)="Reset()">
            <form [formGroup]="dialogForm">
                <div class="row py-3">
                    <div class="col-md-6 col-xl-3 col-xxl-3 ">
                        <label class="form-label ">Manufacturer</label>
                        <p-autoComplete [delay]="1000" formControlName="manufacturer" [suggestions]="assetFormService.manufacturers"
                            field="name" (completeMethod)="selectManufacturer($event)"
                            (onSelect)="bindManufacturer($event)" (onClear)="clearManufacturer()"></p-autoComplete>
                    </div>
                    <div class="col-md-6 col-xl-3 col-xxl-3 ">
                        <label class="form-label ">Asset Serial Number</label>
                        <p-autoComplete [delay]="1000" [suggestions]="assetFormService.Asset_SNs" formControlName="assetSerialNumber"
                            field="assetSerialNo" (completeMethod)="selectSN($event)" (onSelect)="bindSN($event)"
                            (onClear)="clearSN()"></p-autoComplete>
                    </div>
                    <div class="col-md-6 col-xl-3 col-xxl-3 ">
                        <label class="form-label ">Asset Number</label>
                        <p-autoComplete [delay]="1000" [suggestions]="assetFormService.oldAssetNums" formControlName="assetNo"
                            field="assetNumber" (completeMethod)="selectAssetNumber($event)"
                            (onSelect)="bindAssetNumber($event)" (onClear)="clearAssetNumber()"></p-autoComplete>
                    </div>
                    <div class="col-md-6 col-xl-3 col-xxl-3 ">
                        <label class="form-label ">Asset Name</label>
                        <p-autoComplete [delay]="1000" [suggestions]="assetNames" field="assetname" formControlName="assetName"
                            (completeMethod)="selectAssetName($event)" (onSelect)="bindAssetName($event)"
                            (onClear)="clearAssetName()"></p-autoComplete>
                    </div>
                    <div class="col-md-6 col-xl-3 col-xxl-3 ">
                        <label class="form-label ">Model</label>
                        <p-autoComplete [delay]="1000" [suggestions]="models" field="name" formControlName="model"
                            (completeMethod)="selectModel($event)" (onSelect)="bindModel($event)"
                            (onClear)="clearModel()"></p-autoComplete>
                    </div>
                   <div class="col-md-6 col-xl-3 col-xxl-3 ">
                        <label class="form-label ">Department</label>
                        <p-autoComplete [delay]="1000" [suggestions]="departments" field="departmentName" formControlName="department"
                            (completeMethod)="selectDepartment($event)" (onSelect)="bindDepartment($event)"
                            (onClear)="clearDepartment()"></p-autoComplete>
                    </div>
                    <div class="col-md-6 col-xl-3 col-xxl-3 ">
                        <label class="form-label ">Site</label>
                        <p-autoComplete [delay]="1000" [suggestions]="sites" field="custName" formControlName="site"
                            (completeMethod)="selectSite($event)" (onSelect)="bindSite($event)"
                            (onClear)="clearSite()"></p-autoComplete>
                    </div>
                    <div class="col-md-6 col-xl-3 col-xxl-3 ">
                        <label class="form-label ">Supplier</label>
                        <p-autoComplete [delay]="1000" [suggestions]="suppliers" field="suppliername" formControlName="supplier"
                            (completeMethod)="selectSupplier($event)" (onSelect)="bindSupplier($event)"
                            (onClear)="clearSupplier()"></p-autoComplete>
                    </div>
                </div>
            </form>
        </app-search-component> -->
  </div>
  <div>
    <p-table #dt [value]="assetsData" [loading]="loading" [lazy]="true"
      styleClass="p-datatable-striped p-datatable-gridlines" [rows]="pageSize" [tableStyle]="{width :'60vw'}"
      [lazy]="true" [totalRecords]="totalRows" [rowHover]="false" dataKey="id">
      <ng-template pTemplate="caption">
        <div>
          Assets Table <br>
          <span class="total_rows_data"> Total: {{ totalRows }} </span>
        </div>
      </ng-template>
      <ng-template pTemplate="header">
        <tr>
          <th>Asset Number</th>
          <th>Asset Name</th>
          <th>Serial Number</th>
          <th>Model</th>
          <th>Manufacturer</th>
          <th>Supplier</th>
          <th>Department</th>
          <th>Site</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-asset>

        <tr (click)="selectRowasset(asset.id)">


          <td>{{asset.assetNumber}}</td>
          <td>{{asset.modelDefinition.assetName}}</td>
          <td>{{asset.assetSerialNo}}</td>
          <td>{{asset.modelDefinition.modelName}}</td>
          <td>{{asset.modelDefinition.manufacturerName}}</td>
          <td>{{asset.supplier?.suppliername}}</td>
          <td>{{asset.department?.departmentName}}</td>
          <td>{{asset.site.custName}}</td>


        </tr>
      </ng-template>

    </p-table>
    <p-paginator [rows]="searchFilter.pageSize" [totalRecords]="totalRows" (onPageChange)="paginate($event)"
      [showCurrentPageReport]="true"
      currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"></p-paginator>

  </div>

  <ng-template pTemplate="footer">

    <p-button icon="pi pi-times" (click)="showDialogasset=false" label="Cancel" styleClass="p-button-text"></p-button>
  </ng-template>
</div>
<!-- </p-dialog> -->
